<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì‚¬ìš©ì íŒ¨í„´ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    label, select, h2, p { display: block; margin-bottom: 1rem; }
    .analysis { margin-top: 2rem; }
  </style>
</head>
<body>
  <h1>ğŸ“ ì‚¬ìš©ì íŒ¨í„´ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h1>
  <label for="userSelect">ì‚¬ìš©ì ì„ íƒ:</label>
  <select id="userSelect">
    <option value="">-- ë‹‰ë„¤ì„ ì„ íƒ --</option>
  </select>

  <div id="analysis" class="analysis"></div>

  <script>
    // 1) JSON ê²°ê³¼ íŒŒì¼ ë¡œë“œ
    fetch('analysis.json')
      .then(res => res.json())
      .then(data => {
        const select = document.getElementById('userSelect');
        // ë“œë¡­ë‹¤ìš´ ì˜µì…˜ ìƒì„±
        Object.keys(data).forEach(user => {
          const opt = document.createElement('option');
          opt.value = user;
          opt.textContent = user;
          select.appendChild(opt);
        });

        // ì„ íƒ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        select.addEventListener('change', () => {
          const user = select.value;
          const div = document.getElementById('analysis');
          if (!user) {
            div.innerHTML = '';
            return;
          }
          const info = data[user];
          div.innerHTML = `
            <h2>${user} ë¶„ì„ ê²°ê³¼</h2>
            <p>ì´ ë©”ì‹œì§€ ìˆ˜: ${info.total_messages}</p>
            <h3>Top 5 ìì£¼ ì“°ëŠ” ë¬¸ì¥</h3>
            <ul>
              ${info.top_messages.map(([msg, cnt]) => `<li>${msg} (${cnt}íšŒ)</li>`).join('')}
            </ul>
            <h3>Top 10 ìì£¼ ì“°ëŠ” ë‹¨ì–´</h3>
            <ul>
              ${info.top_words.map(([word, cnt]) => `<li>${word} (${cnt}íšŒ)</li>`).join('')}
            </ul>
          `;
        });
      })
      .catch(err => console.error(err));
  </script>
</body>
</html>